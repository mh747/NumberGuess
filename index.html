<html>
<head>
	<title>Number Guess</title>
</head>

<body>
	<h2>Number Guess</h2>
	<br><br>
	<div id='game_form_area'>
		<form name='new_game' id='new_game'>
			Enter Max Value: <input type='text' id='max_value'>
			<input type='submit' value='Start New Game'>
		</form>
		<form name='active_game' id='active_game'>
			Guess! <input type='text' id='guess'>
			<input type='submit' value='Guess'>
		</form>
	</div>
	<br>
	<div id='game_feedback'>
	</div>


	<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<script src="scripts.js"></script>
	<script>
		$('#new_game').hide();
		$('#active_game').hide();
		var game_max_value;
		var secret;
		var game_id;

		$( document ).ready(function(){
			$('#new_game').fadeIn( "slow", function(){
				//ready
			});
		});

		$('#new_game').submit(function(){
			game_max_value = $( '#max_value' ).val();
			var bodyReq = JSON.stringify({
				max_number: game_max_value
			});
			startNewGame(bodyReq, function(msg){
				game_id = msg.game_id;
				secret = msg.secret_number;
			});

			$( '#new_game' ).fadeOut( "slow", function(){
				$( '#active_game' ).fadeIn( "fast", function(){
					//ready
				});
			});

			return false;
		});

		$('#active_game').submit(function(){
			var number = $( '#guess' ).val();
			var reqBody = JSON.stringify({
				'number': number,
				'game_id': game_id
			});
			storeTrial(reqBody, function(msg){
				console.log(msg);
			});
			evalGuess(secret, number, game_max_value, '#game_feedback', function(endGame){
				if(endGame) {
					console.log('end game');
				}
				$( '#guess' ).val('');
			});

			return false;
		});
	</script>

</body>
</html>
